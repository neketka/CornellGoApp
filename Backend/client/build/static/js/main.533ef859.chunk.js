(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{109:function(e,t,n){"use strict";n.r(t);var r,c,a=n(0),i=n.n(a),o=n(12),s=n.n(o),l=(n(93),n(139)),u=n(175),j=n(161),d=n(158),b=n(162),O=n(163),p=n(165),h=n(169),f=n(170),x=n(26),m=n(164),v=n(166),g=n(167),y=n(168),w=n(69),C=n(15),A=n(14),k=n(141),P=n(143),S=n(144),U=n(146),W=n(147),B=n(148),I=n(150),R=n(151),D=n(152),L=n(153),M=n(154),N=n(155),E=n(156),T=n(171),F=n(62),q=n(172),z=n(159),G=n(145),_=n(149),H=n(160),J=n(59),K=n(20),Q=n(22),V=n.n(Q),X=n(36),Y=n(75),Z=n(2);!function(e){e[e.NoAdminApproval=0]="NoAdminApproval",e[e.AdminRejected=1]="AdminRejected",e[e.NoAccount=2]="NoAccount",e[e.WrongPassword=3]="WrongPassword",e[e.Success=4]="Success"}(r||(r={})),function(e){e[e.Created=0]="Created",e[e.Destroyed=1]="Destroyed",e[e.Modified=2]="Modified"}(c||(c={}));var $=Object(a.createContext)({places:[],unapprovedAdmins:[],loggedIn:!1,addPlace:function(e){},deletePlace:function(e){},modifyPlace:function(e,t){},updateAdmin:function(e,t){},login:function(){var e=Object(X.a)(V.a.mark((function e(t,n){return V.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",r.AdminRejected);case 1:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),requestAdmin:function(){var e=Object(X.a)(V.a.mark((function e(t,n){return V.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",!1);case 1:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()});function ee(e){var t=Object(a.useState)([]),n=Object(A.a)(t,2),i=n[0],o=n[1],s=Object(a.useState)([]),l=Object(A.a)(s,2),u=l[0],j=l[1],d=Object(a.useState)(!1),b=Object(A.a)(d,2),O=b[0],p=b[1],h=Object(a.useRef)(),f=Object(a.useRef)({modified:function(e,t){},approval:function(e,t){},logout:function(){}}),x=Object(a.useRef)([]);Object(a.useEffect)((function(){f.current.modified=function(e,t){switch(e){case c.Created:o([t].concat(Object(K.a)(i)));break;case c.Destroyed:o(i.filter((function(e){return e.id!==t.id})));break;case c.Modified:var n=i.findIndex((function(e){return e.id===t.id}));console.log(n,i),n>=0&&(i[n]=t,o(Object(K.a)(i)))}},f.current.approval=function(e,t){j(t?u.filter((function(t){return t!==e})):[].concat(Object(K.a)(u),[e]))},f.current.logout=function(){p(!1)}})),Object(a.useEffect)((function(){h.current=(new Y.a).withUrl("/adminhub").withAutomaticReconnect().build(),h.current.on("PlaceModified",(function(e,t){return f.current.modified(e,t)})),h.current.on("AdminApprovalUpdate",(function(e,t){return f.current.approval(e,t)})),h.current.onclose((function(e){return f.current.logout()})),h.current.onreconnected((function(e){return f.current.logout()})),h.current.start().catch((function(e){return console.log(e)}))}),[]);var m={places:i,unapprovedAdmins:u,loggedIn:O,addPlace:function(e){var t;null===(t=h.current)||void 0===t||t.invoke("ModifyPlace",c.Created,e).then(p)},deletePlace:function(e){var t;null===(t=h.current)||void 0===t||t.invoke("ModifyPlace",c.Destroyed,{id:e,imageUrl:"",name:"",description:"",points:0,lat:0,long:0,radius:0,citationUrl:"",linkUrl:"",longDescription:""}).then(p)},modifyPlace:function(e,t){var n;null===(n=h.current)||void 0===n||n.invoke("ModifyPlace",c.Modified,Object(C.a)(Object(C.a)({},t),{},{id:e})).then(p)},updateAdmin:function(e,t){var n;null===(n=h.current)||void 0===n||n.invoke("UpdateAdminStatus",e,t).then(p)},login:function(){var e=Object(X.a)(V.a.mark((function e(t,n){var c,a,i,s;return V.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,null===(c=h.current)||void 0===c?void 0:c.invoke("Login",t,n);case 2:return(a=e.sent)===r.Success&&(x.current=[],null===(i=h.current)||void 0===i||i.stream("GetPlaces").subscribe({next:function(e){console.log(e),x.current.push(e)},complete:function(){return o(x.current.reverse())},error:function(e){}}),null===(s=h.current)||void 0===s||s.invoke("GetUnapprovedAdmins").then((function(e){return j([].concat(Object(K.a)(e),Object(K.a)(u)))})),p(!0)),e.abrupt("return",a);case 5:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),requestAdmin:function(){var e=Object(X.a)(V.a.mark((function e(t,n){var r;return V.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,null===(r=h.current)||void 0===r?void 0:r.invoke("RequestAdmin",t,n);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()};return Object(Z.jsx)($.Provider,{value:m,children:e.children})}var te=Object(l.a)((function(e){return{media:{paddingTop:"40%"}}}));function ne(e){var t=e.id,n=e.name,r=e.imageUrl,c=e.description,a=e.points,i=e.remove,o=e.edit,s=te();return Object(Z.jsxs)(k.a,{children:[Object(Z.jsx)(P.a,{action:Object(Z.jsx)(S.a,{onClick:function(){return o(t)},children:Object(Z.jsx)(G.a,{})}),title:n,subheader:a+(1===a?" point":" points")}),Object(Z.jsx)(U.a,{image:r,className:s.media}),Object(Z.jsx)(W.a,{children:Object(Z.jsx)(x.a,{variant:"body2",color:"textSecondary",component:"p",children:c})}),Object(Z.jsx)(B.a,{disableSpacing:!0,children:Object(Z.jsx)(S.a,{onClick:function(){return i(t)},children:Object(Z.jsx)(_.a,{})})})]})}function re(e){var t,n=e.id,r=e.close,c=e.isOpen,i=Object(a.useContext)($);return Object(Z.jsxs)(I.a,{open:c,onClose:r,children:[Object(Z.jsx)(R.a,{children:"Delete this place?"}),Object(Z.jsx)(D.a,{children:Object(Z.jsxs)(L.a,{id:"alert-dialog-description",children:['Are you sure you want to delete "',null===(t=i.places.find((function(e){return e.id===n})))||void 0===t?void 0:t.name,'"?']})}),Object(Z.jsxs)(M.a,{children:[Object(Z.jsx)(N.a,{onClick:r,color:"primary",children:"Cancel"}),Object(Z.jsx)(N.a,{onClick:function(){i.deletePlace(n),r()},color:"secondary",autoFocus:!0,children:"Delete"})]})]})}function ce(e){var t=e.id,n=e.close,r=e.isOpen,c={name:"",id:"",imageUrl:"",description:"",lat:0,long:0,points:0,radius:0,citationUrl:"",linkUrl:"",longDescription:""},i=Object(a.useState)(c),o=Object(A.a)(i,2),s=o[0],l=o[1],u=Object(a.useContext)($);Object(a.useEffect)((function(){if(r)if("_new"===t)l(c);else{var e=u.places.find((function(e){return e.id===t}));e&&l(e)}}),[r,t,u]);return Object(Z.jsxs)(I.a,{open:r,onClose:n,scroll:"body",fullWidth:!0,maxWidth:"sm",children:[Object(Z.jsx)(R.a,{children:"_new"===t?"New Place":"Edit Place"}),Object(Z.jsx)(D.a,{children:Object(Z.jsxs)(E.a,{container:!0,children:[Object(Z.jsx)(E.a,{container:!0,children:Object(Z.jsx)(T.a,{label:"Name",value:s.name,onChange:function(e){return l(Object(C.a)(Object(C.a)({},s),{},{name:e.target.value}))},style:{marginBottom:4},fullWidth:!0})}),Object(Z.jsx)(E.a,{container:!0,children:Object(Z.jsx)(T.a,{label:"Points",value:s.points,onChange:function(e){return l(Object(C.a)(Object(C.a)({},s),{},{points:parseInt(e.target.value)}))},type:"number",style:{marginBottom:8},fullWidth:!0})}),Object(Z.jsx)(E.a,{container:!0,children:Object(Z.jsx)(T.a,{label:"Latitude",type:"number",value:s.lat,onChange:function(e){return l(Object(C.a)(Object(C.a)({},s),{},{lat:parseFloat(e.target.value)}))},style:{marginBottom:8},fullWidth:!0})}),Object(Z.jsx)(E.a,{container:!0,children:Object(Z.jsx)(T.a,{label:"Longitude",type:"number",value:s.long,onChange:function(e){return l(Object(C.a)(Object(C.a)({},s),{},{long:parseFloat(e.target.value)}))},style:{marginBottom:8},fullWidth:!0})}),Object(Z.jsx)(E.a,{container:!0,children:Object(Z.jsx)(T.a,{label:"Awarding distance in meters",type:"number",value:s.radius,onChange:function(e){return l(Object(C.a)(Object(C.a)({},s),{},{radius:parseFloat(e.target.value)}))},style:{marginBottom:8},fullWidth:!0})}),Object(Z.jsx)(E.a,{container:!0,children:Object(Z.jsx)(T.a,{label:"Image URL",value:s.imageUrl,onChange:function(e){return l(Object(C.a)(Object(C.a)({},s),{},{imageUrl:e.target.value}))},style:{marginBottom:8},fullWidth:!0})}),Object(Z.jsx)(E.a,{container:!0,children:Object(Z.jsx)(T.a,{label:"Guiding Description",value:s.description,onChange:function(e){return l(Object(C.a)(Object(C.a)({},s),{},{description:e.target.value}))},inputProps:{maxLength:100},style:{marginBottom:8},fullWidth:!0,multiline:!0})}),Object(Z.jsx)(E.a,{container:!0,children:Object(Z.jsx)(T.a,{label:"Learn More Description",value:s.longDescription,onChange:function(e){return l(Object(C.a)(Object(C.a)({},s),{},{longDescription:e.target.value}))},style:{marginBottom:8},fullWidth:!0,multiline:!0})}),Object(Z.jsx)(E.a,{container:!0,children:Object(Z.jsx)(T.a,{label:"Learn More Citation URL",value:s.citationUrl,onChange:function(e){return l(Object(C.a)(Object(C.a)({},s),{},{citationUrl:e.target.value}))},style:{marginBottom:8},fullWidth:!0,multiline:!0})}),Object(Z.jsx)(E.a,{container:!0,children:Object(Z.jsx)(T.a,{label:"Learn More URL",value:s.linkUrl,onChange:function(e){return l(Object(C.a)(Object(C.a)({},s),{},{linkUrl:e.target.value}))},style:{marginBottom:8},fullWidth:!0,multiline:!0})})]})}),Object(Z.jsxs)(M.a,{children:[Object(Z.jsx)(N.a,{onClick:n,color:"primary",children:"Cancel"}),Object(Z.jsx)(N.a,{onClick:function(){"_new"===t?u.addPlace(s):u.modifyPlace(t,s),n()},color:"primary",children:"Save"})]})]})}function ae(e){Object(w.a)(e);var t=Object(a.useState)(!1),n=Object(A.a)(t,2),r=n[0],c=n[1],i=Object(a.useState)("_new"),o=Object(A.a)(i,2),s=o[0],l=o[1],u=Object(a.useState)(!1),j=Object(A.a)(u,2),d=j[0],b=j[1],O=Object(a.useState)(""),p=Object(A.a)(O,2),h=p[0],f=p[1],x=Object(a.useRef)(0),m=Object(a.useContext)($),v=function(e){l(e),c(!0)},g=function(e){l(e),b(!0)},y=Object(a.useState)([]),C=Object(A.a)(y,2),k=C[0],P=C[1];return Object(a.useEffect)((function(){var e=function(e){return{id:e.id,name:e.name,points:e.points,url:e.imageUrl,description:e.description}},t=function(e,t){return J.compareTwoStrings(t.name,h)-J.compareTwoStrings(e.name,h)};clearTimeout(x.current),""===h?P(m.places.map(e)):x.current=window.setTimeout((function(){P(m.places.map(e).sort(t))}),300)}),[m,h]),Object(Z.jsxs)(Z.Fragment,{children:[Object(Z.jsx)(re,{id:s,isOpen:d,close:function(){return b(!1)}}),Object(Z.jsx)(ce,{id:s,isOpen:r,close:function(){return c(!1)}}),Object(Z.jsxs)(E.a,{container:!0,justify:"center",alignContent:"center",children:[Object(Z.jsxs)(E.a,{container:!0,style:{position:"sticky",top:90,opacity:.95,zIndex:100},children:[Object(Z.jsx)(E.a,{item:!0,xs:1}),Object(Z.jsx)(E.a,{item:!0,xs:10,children:Object(Z.jsx)(F.a,{elevation:1,children:Object(Z.jsxs)(E.a,{container:!0,spacing:2,alignItems:"center",children:[Object(Z.jsx)(E.a,{item:!0,xs:6,children:Object(Z.jsx)(q.a,{ml:1,children:Object(Z.jsx)(N.a,{onClick:function(){l("_new"),c(!0)},children:"New Place"})})}),Object(Z.jsx)(E.a,{item:!0,xs:!0,children:Object(Z.jsx)(q.a,{mr:1,children:Object(Z.jsx)(T.a,{id:"input-with-icon-grid",variant:"outlined",size:"small",type:"search",onChange:function(e){return f(e.target.value)},fullWidth:!0,InputProps:{startAdornment:Object(Z.jsx)(z.a,{position:"start",children:Object(Z.jsx)(H.a,{})})}})})})]})})})]}),Object(Z.jsx)(E.a,{container:!0,style:{marginTop:32},children:k.map((function(e){return Object(Z.jsxs)(E.a,{container:!0,style:{marginBottom:16},children:[Object(Z.jsx)(E.a,{xs:3,item:!0}),Object(Z.jsx)(E.a,{xs:6,item:!0,children:Object(Z.jsx)(ne,{id:e.id,name:e.name,imageUrl:e.url,description:e.description,points:e.points,edit:v,remove:g})})]},e.id)}))})]})]})}var ie=n(173);function oe(e){var t=e.name,n=Object(a.useContext)($);return Object(Z.jsxs)(k.a,{children:[Object(Z.jsx)(P.a,{title:"Request for Admin Access"}),Object(Z.jsxs)(W.a,{children:[Object(Z.jsx)(x.a,{variant:"body1",component:"span",children:"Email Address:"}),Object(Z.jsx)(x.a,{variant:"body2",component:"span",children:" "+t})]}),Object(Z.jsxs)(B.a,{children:[Object(Z.jsx)(N.a,{size:"small",onClick:function(){return n.updateAdmin(t,!0)},children:"Approve"}),Object(Z.jsx)(N.a,{size:"small",onClick:function(){return n.updateAdmin(t,!1)},color:"secondary",children:"Deny"})]})]})}function se(){var e=Object(a.useContext)($);return Object(Z.jsxs)(E.a,{container:!0,justify:"center",children:[0===e.unapprovedAdmins.length?Object(Z.jsx)(x.a,{children:"No admins need approval"}):null,e.unapprovedAdmins.map((function(e){return Object(Z.jsxs)(E.a,{container:!0,style:{marginBottom:16},children:[Object(Z.jsx)(E.a,{xs:3,item:!0}),Object(Z.jsx)(E.a,{xs:6,item:!0,children:Object(Z.jsx)(oe,{name:e})})]},e)}))]})}var le=Object(l.a)((function(e){return{root:{display:"flex"},appBar:{zIndex:e.zIndex.drawer+1},drawer:{width:240,flexShrink:0},drawerPaper:{width:240},drawerContainer:{overflow:"auto"},content:{flexGrow:1,padding:e.spacing(3)}}}));function ue(e){var t=e.drawerClass,n=e.drawerPaper,r=Object(ie.d)();return Object(Z.jsxs)(u.a,{variant:"permanent",className:t,classes:{paper:n},children:[Object(Z.jsx)(j.a,{}),Object(Z.jsxs)(d.a,{children:[Object(Z.jsxs)(b.a,{button:!0,onClick:function(){return r.push("/")},children:[Object(Z.jsx)(O.a,{children:Object(Z.jsx)(m.a,{})}),Object(Z.jsx)(p.a,{primary:"Home"})]}),Object(Z.jsxs)(b.a,{button:!0,onClick:function(){return r.push("/places")},children:[Object(Z.jsx)(O.a,{children:Object(Z.jsx)(v.a,{})}),Object(Z.jsx)(p.a,{primary:"Places"})]}),Object(Z.jsxs)(b.a,{button:!0,onClick:function(){return r.push("/admins")},children:[Object(Z.jsx)(O.a,{children:Object(Z.jsx)(g.a,{})}),Object(Z.jsx)(p.a,{primary:"Admin Approval"})]}),Object(Z.jsxs)(b.a,{button:!0,onClick:function(){return r.push("/users")},children:[Object(Z.jsx)(O.a,{children:Object(Z.jsx)(y.a,{})}),Object(Z.jsx)(p.a,{primary:"Users"})]})]})]})}function je(){var e=le();return Object(Z.jsxs)(ie.a,{children:[Object(Z.jsxs)(h.a,{position:"fixed",className:e.appBar,children:[Object(Z.jsx)(f.a,{}),Object(Z.jsx)(j.a,{children:Object(Z.jsx)(x.a,{variant:"subtitle1",color:"inherit",children:"CornellGO! Manager"})})]}),Object(Z.jsx)(ue,{drawerClass:e.drawer,drawerPaper:e.drawerPaper}),Object(Z.jsx)("div",{style:{marginLeft:240,marginTop:84},children:Object(Z.jsxs)(ie.c,{children:[Object(Z.jsx)(ie.b,{path:"/",exact:!0,children:Object(Z.jsx)("div",{children:"Home"})}),Object(Z.jsx)(ie.b,{path:"/places",children:Object(Z.jsx)(ae,{})}),Object(Z.jsx)(ie.b,{path:"/admins",children:Object(Z.jsx)(se,{})}),Object(Z.jsx)(ie.b,{path:"/users",children:Object(Z.jsx)("div",{children:"Users"})})]})})]})}var de=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,177)).then((function(t){var n=t.getCLS,r=t.getFID,c=t.getFCP,a=t.getLCP,i=t.getTTFB;n(e),r(e),c(e),a(e),i(e)}))},be=n(174),Oe=n(74);function pe(e){var t=Object(a.useContext)($),n=Object(a.useState)(""),c=Object(A.a)(n,2),i=c[0],o=c[1],s=Object(a.useState)(""),l=Object(A.a)(s,2),u=l[0],j=l[1],d=Object(a.useState)(""),b=Object(A.a)(d,2),O=b[0],p=b[1],h=Object(a.useState)(""),f=Object(A.a)(h,2),x=f[0],m=f[1],v=Object(a.useState)(!1),g=Object(A.a)(v,2),y=g[0],w=g[1],C=function(){var e=Object(X.a)(V.a.mark((function e(){var n;return V.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.login(i,u);case 2:n=e.sent,p(n===r.NoAdminApproval?"Email is awaiting response":n===r.AdminRejected?"Email has been rejected":n===r.NoAccount?"Email has not been registered":""),n===r.WrongPassword&&m("Incorrect password");case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),k=function(){var e=Object(X.a)(V.a.mark((function e(){return V.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(Oe.validate(i)){e.next=3;break}return p("Invaild email format!"),e.abrupt("return");case 3:return e.next=5,t.requestAdmin(i,u);case 5:e.sent?(p(""),w(!0)):p("Email is awaiting response or rejected");case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(Z.jsxs)(Z.Fragment,{children:[Object(Z.jsxs)(I.a,{open:!t.loggedIn,scroll:"body",fullWidth:!0,maxWidth:"sm",children:[Object(Z.jsx)(R.a,{children:"CornellGO! Manager"}),Object(Z.jsx)(D.a,{children:Object(Z.jsx)(E.a,{container:!0,children:Object(Z.jsxs)(E.a,{container:!0,children:[Object(Z.jsx)(T.a,{label:"Email",value:i,onChange:function(e){return o(e.target.value)},style:{marginBottom:4},error:O.length>0,helperText:O,fullWidth:!0}),Object(Z.jsx)(T.a,{label:"Password",value:u,type:"password",onChange:function(e){return j(e.target.value)},style:{marginBottom:4},error:x.length>0,helperText:x,fullWidth:!0})]})})}),Object(Z.jsxs)(M.a,{children:[Object(Z.jsx)(N.a,{onClick:C,color:"primary",children:"Login"}),Object(Z.jsx)(N.a,{onClick:k,color:"primary",children:"Request Access"})]})]}),Object(Z.jsx)(be.a,{anchorOrigin:{vertical:"bottom",horizontal:"center"},open:y,autoHideDuration:6e3,onClose:function(){return w(!1)},message:"Requested admin access"}),t.loggedIn&&e.children]})}s.a.render(Object(Z.jsx)(i.a.StrictMode,{children:Object(Z.jsx)(ee,{children:Object(Z.jsx)(pe,{children:Object(Z.jsx)(je,{})})})}),document.getElementById("root")),de()},93:function(e,t,n){}},[[109,1,2]]]);
//# sourceMappingURL=main.533ef859.chunk.js.map